<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson09_Scenario9</title>
    <style>
        body {
            max-width: 600px;
            margin: auto;
            padding: 0 15px;
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
        
        .student-info-container {
            padding: 10px;
        }
        
        .input-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .input-group input {
            flex: 1;
            min-width: 150px;
            padding: 10px;
            font-size: 16px;
        }
        
        .pdf-button {
            padding: 10px 10px;
            font-size: 16px;
            cursor: pointer;
        }
        
        .pdf-button:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .note {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        .save-container {
            padding: 10px;
        }
        
        .file-input-group {
            margin-bottom: 15px;
        }
        
        .file-input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .file-input-group input {
            width: 100%;
            max-width: 300px;
            padding: 10px;
            font-size: 16px;
        }
        
        /* Lesson Content Styles */
        .lessonContent {
            padding: 20px 10px;
        }
        
        .lessonContent[contenteditable="true"] {
            border: 2px dashed #4CAF50;
            background-color: #f9fff9;
            padding: 15px;
        }
        
        .lesson-header {
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .lesson-header h1 {
            margin: 0 0 5px 0;
            font-size: 24px;
            color: #333;
        }
        
        .lesson-header .subtitle {
            color: #666;
            font-style: italic;
            font-size: 14px;
        }
        
        .scenario-overview {
            background-color: #f5f5f5;
            border-top: 4px solid #FF9800;
            padding: 15px;
            margin-bottom: 25px;
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.15);
        }
        
        .scenario-overview h2 {
            margin-top: 0;
            font-size: 18px;
            color: #2196F3;
        }
        
        .scenario-overview p {
            margin: 10px 0;
        }
        
        .participants {
            font-size: 14px;
            color: #555;
            margin-top: 10px;
        }
        
        .participants strong {
            color: #333;
        }
        
        .dialogue-section {
            margin-top: 30px;
        }
        
        .dialogue-section h2 {
            font-size: 18px;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        
        .dialogue-line {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #2196F3;
            box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.15);
        }
        
        .speaker {
            font-weight: bold;
            color: #1976D2;
            margin-bottom: 3px;
        }
        
        .speech {
            margin-left: 20px;
            text-align: justify;
        }
        
        /* Highlighting styles */
        .idiom {
            color: #D84315;
        }
        
        .vocab-a2 {
            color: #1565C0;
        }
        
        .collocation {
            color: #7B1FA2;
        }
    </style>
</head>
<body>
    <div class="lessonContent" contenteditable="false">
        <div class="lesson-header">
            <h1>Lesson 9: Financial Negotiation Discussion</h1>
            <p class="subtitle">Scenario 9: Structuring the Endorsement Deal</p>
        </div>
        
        <div class="scenario-overview">
            <h2>Scenario Overview</h2>
            <p>Company president Sally joins the meeting to discuss financial terms for Jenny's endorsement. They explore payment options including a flat rate versus percentage of sales, and consider stock options. Charles expresses concerns about stock making Jenny appear too affiliated with the company. They settle on a percentage fee for annual endorsement of four specific products (serum, contours, eye shadow, foundation), with the contract renewable annually by mutual agreement. Charles requests complimentary products as part of the deal, which Sally agrees to include in the contract.</p>
            
            <div class="participants">
                <strong>Participants:</strong> Sally (Company President), Charles (Jenny's Representative)
            </div>
        </div>
        
        <div class="dialogue-section">
            <h2>Dialogue</h2>
            
            <div class="dialogue-line">
                <div class="speaker">Sally:</div>
                <div class="speech">Hello everyone, sorry for joining the meeting a little late. I understand we're discussing the <span class="collocation">financial aspects</span> of Jenny's endorsement. Let's <span class="idiom">delve into</span> it.</div>
            </div>
            
            <div class="dialogue-line">
                <div class="speaker">Charles:</div>
                <div class="speech">Welcome, Sally. We were just discussing how to <span class="vocab-a2">structure</span> the payment for Jenny's endorsement. One option is offering her a <span class="collocation">flat rate</span> for the endorsement, while the other is providing her with a <span class="collocation">percentage of sales</span> generated by the endorsed products. Additionally, we <span class="idiom">touched upon</span> the possibility of <span class="collocation">stock options</span>.</div>
            </div>
            
            <div class="dialogue-line">
                <div class="speaker">Sally:</div>
                <div class="speech">Thank you for <span class="vocab-a2">summarizing</span>, Charles. It's an important decision to make. While stock options can be <span class="vocab-a2">enticing</span>, I understand your concerns about Jenny being <span class="vocab-a2">perceived</span> as overly <span class="vocab-a2">affiliated</span> with our company. We value the <span class="vocab-a2">integrity</span> of our endorsements and don't want to <span class="vocab-a2">compromise</span> her <span class="vocab-a2">credibility</span>.</div>
            </div>
            
            <div class="dialogue-line">
                <div class="speaker">Charles:</div>
                <div class="speech">Exactly, Sally. We want to <span class="idiom">maintain a balance</span> between promoting our brand and ensuring Jenny's <span class="collocation">independent status</span>. Therefore, I suggest we focus on a <span class="collocation">percentage fee</span> for an <span class="collocation">annual endorsement</span> of specific products. This way, Jenny will be <span class="vocab-a2">compensated</span> fairly based on the success of the endorsed products without directly tying her to the company's <span class="collocation">financial performance</span>.</div>
            </div>
            
            <div class="dialogue-line">
                <div class="speaker">Sally:</div>
                <div class="speech">That sounds <span class="vocab-a2">reasonable</span>, Charles. We can <span class="vocab-a2">outline</span> the percentage fee structure in the contract and <span class="vocab-a2">specify</span> the four particular products we want Jenny to endorseâ€”the serum, contours, eye shadow, and foundation. We can <span class="vocab-a2">evaluate</span> the performance of these products annually to determine the fee.</div>
            </div>
            
            <div class="dialogue-line">
                <div class="speaker">Charles:</div>
                <div class="speech">Agreed, Sally. Having an annual endorsement agreement allows for <span class="vocab-a2">flexibility</span> and assessment of the ongoing partnership. It ensures that all parties can <span class="vocab-a2">reevaluate</span> the terms based on their satisfaction and any changing circumstances. We can include a clause stating that the contract is <span class="collocation">renewable annually</span> upon <span class="collocation">mutual agreement</span>.</div>
            </div>
            
            <div class="dialogue-line">
                <div class="speaker">Sally:</div>
                <div class="speech">That's a good addition, Charles. It provides a level of flexibility and ensures that both parties can assess the collaboration and make <span class="vocab-a2">informed decisions</span> <span class="idiom">moving forward</span>.</div>
            </div>
            
            <div class="dialogue-line">
                <div class="speaker">Charles:</div>
                <div class="speech">Lastly, Sally, Jenny has expressed interest in receiving <span class="collocation">free products</span> as part of the <span class="collocation">endorsement deal</span>. It would be beneficial to provide her with the endorsed products regularly, not only for her personal use but also to showcase her commitment to the brand.</div>
            </div>
            
            <div class="dialogue-line">
                <div class="speaker">Sally:</div>
                <div class="speech">I understand the request, Charles. Including <span class="vocab-a2">complimentary</span> products as part of the endorsement deal can be a <span class="idiom">mutually beneficial</span> arrangement. It showcases our confidence in the products and allows Jenny to experience and advocate for them <span class="vocab-a2">genuinely</span>. We can outline the specific quantities and regularity of product distribution in the contract.</div>
            </div>
        </div>
    </div>

    <div class="student-info-container">
        <div class="input-group">
            <input type="text" id="studentName" value="Name" maxlength="25">
            <input type="text" id="studentID" value="ID" maxlength="25">
        </div>
        
        <button id="pdfButton" class="pdf-button" disabled="">Print/Save as PDF</button>
        
        <p class="note">Name and ID required for PDF print.</p>
    </div>
    
    <div class="save-container">
        <div class="file-input-group editMode" style="display: none;">
            <label for="fileName">File Name</label>
            <input type="text" id="fileName" class="editMode" value="Lesson09_Scenario9.html" style="display: none;">
        </div>
        
        <button id="saveButton" class="editMode" style="display: none;">Save as Local File</button>
    </div>

    <script>
        // Initialize save functionality on page load
        document.addEventListener('DOMContentLoaded', function() {
            const saveButton = document.getElementById('saveButton');
            const fileNameInput = document.getElementById('fileName');
            
            saveButton.addEventListener('click', function() {
                saveFiles();
            });
            
            function saveFiles() {
                // Get the filename without .html extension
                let fileName = fileNameInput.value.trim();
                if (fileName.endsWith('.html')) {
                    fileName = fileName.slice(0, -5);
                }
                
                // UPDATE TITLE TO MATCH FILENAME
                document.title = fileName;                
                
                // FIRST SAVE: Current editable state
                const editableHTML = getFullHTML();
                downloadFile(editableHTML, fileName + 'EditMode.html');
                
                // Store current states
                const editableElements = document.querySelectorAll('[contenteditable="true"]');
                const editModeElements = document.querySelectorAll('.editMode');
                
                // DISABLE EDITING: Set contenteditable to false
                editableElements.forEach(el => {
                    el.setAttribute('contenteditable', 'false');
                });
                
                // HIDE EDIT MODE: Set editMode class to display:none
                editModeElements.forEach(el => {
                    el.style.display = 'none';
                });
                
                // SECOND SAVE: Clean public version
                const publicHTML = getFullHTML();
                downloadFile(publicHTML, fileName + '.html');
                
                // RESTORE EDITING: Set contenteditable back to true
                editableElements.forEach(el => {
                    el.setAttribute('contenteditable', 'true');
                });
                
                // RESTORE EDIT MODE: Set editMode class back to display:block
                editModeElements.forEach(el => {
                    el.style.display = 'block';
                });
            }
            
            function getFullHTML() {
                // Get the complete HTML including DOCTYPE
                const doctype = '<!DOCTYPE html>\n';
                const html = document.documentElement.outerHTML;
                return doctype + html;
            }
            
            function downloadFile(content, filename) {
                // Create blob from content
                const blob = new Blob([content], { type: 'text/html' });
                
                // Create download link
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = filename;
                
                // Trigger download
                document.body.appendChild(a);
                a.click();
                
                // Cleanup
                document.body.removeChild(a);
                URL.revokeObjectURL(a.href);
            }
        });
    </script>

    <script>
        const nameInput = document.getElementById('studentName');
        const idInput = document.getElementById('studentID');
        const pdfButton = document.getElementById('pdfButton');
        
        const DEFAULTS = {
            name: 'Name',
            id: 'ID'
        };
        
        // Sanitize input to prevent injection
        function sanitizeInput(input) {
            const temp = document.createElement('div');
            temp.textContent = input;
            return temp.innerHTML;
        }
        
        // Validate input length and content
        function validateInput(input, fieldName) {
            const sanitized = sanitizeInput(input.trim());
            
            if (sanitized.length < 2) {
                alert(`${fieldName} must be at least 2 characters long.`);
                return false;
            }
            
            if (sanitized.length > 25) {
                alert(`${fieldName} must be no more than 25 characters long.`);
                return false;
            }
            
            return true;
        }
        
        // Check if both fields are valid and changed from defaults
        function checkEnablePDF() {
            const nameValue = nameInput.value.trim();
            const idValue = idInput.value.trim();
            
            // Check if changed from defaults
            const nameChanged = nameValue !== DEFAULTS.name;
            const idChanged = idValue !== DEFAULTS.id;
            
            // Check if valid
            const nameValid = nameValue.length >= 2 && nameValue.length <= 25;
            const idValid = idValue.length >= 2 && idValue.length <= 25;
            
            // Enable button only if both changed AND both valid
            pdfButton.disabled = !(nameChanged && idChanged && nameValid && idValid);
        }
        
        // Validate on blur (when user leaves field)
        nameInput.addEventListener('blur', function() {
            const value = this.value.trim();
            if (value !== DEFAULTS.name && value.length > 0) {
                if (validateInput(value, 'Name')) {
                    this.value = sanitizeInput(value);
                } else {
                    this.value = DEFAULTS.name;
                }
            }
            checkEnablePDF();
        });
        
        idInput.addEventListener('blur', function() {
            const value = this.value.trim();
            if (value !== DEFAULTS.id && value.length > 0) {
                if (validateInput(value, 'ID')) {
                    this.value = sanitizeInput(value);
                } else {
                    this.value = DEFAULTS.id;
                }
            }
            checkEnablePDF();
        });
        
        // Also check on input to provide immediate feedback for enabling button
        nameInput.addEventListener('input', checkEnablePDF);
        idInput.addEventListener('input', checkEnablePDF);
        
        // Clear default on focus
        nameInput.addEventListener('focus', function() {
            if (this.value === DEFAULTS.name) {
                this.value = '';
            }
        });
        
        idInput.addEventListener('focus', function() {
            if (this.value === DEFAULTS.id) {
                this.value = '';
            }
        });
        
        // PDF Print functionality
        pdfButton.addEventListener('click', function() {
            window.print();
        });
    </script>


</body></html>