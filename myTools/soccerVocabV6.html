<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Vocabulary Transform Tool</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            line-height: 1.6;
        }
        h1, h2 {
            text-align: center;
        }
        textarea {
            width: 100%;
            min-height: 150px;
            font-size: 1em;
            font-family: Arial, sans-serif;
            padding: 10px;
            margin-bottom: 10px;
            resize: vertical;
        }
        #fileNameInput {
            width: 100%;
            font-size: 1em;
            font-family: Arial, sans-serif;
            padding: 10px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        button {
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            font-size: 1em;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        #output {
            margin-bottom: 20px;
        }
        .output-section {
            padding: 10px;
            border: 1px solid #ddd;
            margin-bottom: 10px;
            min-height: 50px;
            position: relative;
        }
        .delete-btn {
            background-color: #dc3545;
            color: white;
            padding: 8px 12px;
            font-size: 1em;
            margin-bottom: 10px;
            display: block;
            margin-left: auto;
            margin-right: 10px;
        }
        .delete-btn:hover {
            background-color: #c82333;
        }
        select {
            font-size: 1em;
            font-family: Arial, sans-serif;
            border: none;
            background: transparent;
            cursor: pointer;
            padding: 0;
            margin: 0;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            outline: none;
            font-weight: bold;
        }
        select option {
            color: black;
        }
        .default {
            color: blue;
        }
        .correct {
            color: green;
        }
        .incorrect {
            color: red;
        }
        p {
            margin: 10px 0;
            word-wrap: break-word;
            line-height: 1.8;
        }
        @media (max-width: 600px) {
            select, p {
                font-size: 1.1em;
            }
            .output-section {
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <h1>Teacher Vocabulary Transform Tool</h1>
    <h2>Create Interactive Vocabulary Exercises</h2>
    <p>Paste a paragraph or article below with words in {{word1,word2,word3,...}} format. Word1 is the default (blue), word2 is the correct answer (green when selected), and the rest are distractors (red when selected). Click "Transform" to generate the exercise above the textarea. Use "Delete Forever" to remove a section if needed. Enter a file name and click "Save to Download Folder" to export as an HTML file.</p>
    <div id="output"><div class="output-section"><button class="delete-btn" style="display: none;">Delete Forever</button><p>Soccer is a 
                        <select id="select-1745575981137-0-0" class="default" data-correct="fantastic"><option value="wonderful">wonderful</option><option value="fantastic">fantastic</option><option value="Horrible">Horrible</option><option value="PLAIN!@#">PLAIN!@#</option></select>
                     sport loved by billions. It’s 
                        <select id="select-1745575981137-0-1" class="default" data-correct="."><option value="simple">simple</option><option value="...">...</option><option value=".">.</option><option value="sad">sad</option><option value="easy">easy</option><option value="complex">complex</option></select>
                     to play, needing only a ball and some 
                        <select id="select-1745575981137-0-2" class="default" data-correct="area"><option value="space">space</option><option value="food">food</option><option value="time">time</option><option value="area">area</option></select>
                    . Fans find it 
                        <select id="select-1745575981137-0-3" class="default" data-correct="thrilling"><option value="exciting">exciting</option><option value="boring">boring</option><option value="thrilling">thrilling</option><option value="calm">calm</option></select>
                     to watch! Soccer is a 
                        <select id="select-1745575981137-0-4" class="default" data-correct="fantastic"><option value="wonderful">wonderful</option><option value="plain">plain</option><option value="fantastic">fantastic</option><option value="terrible">terrible</option></select>
                     sport loved by billions. It’s 
                        <select id="select-1745575981137-0-5" class="default" data-correct="easy"><option value="simple">simple</option><option value="easy">easy</option><option value="complex">complex</option><option value="sad">sad</option></select>
                     to play, needing only a ball and some 
                        <select id="select-1745575981137-0-6" class="default" data-correct="area"><option value="space">space</option><option value="area">area</option><option value="time">time</option><option value="food">food</option></select>
                    . Fans find it 
                        <select id="select-1745575981137-0-7" class="default" data-correct="thrilling"><option value="exciting">exciting</option><option value="thrilling">thrilling</option><option value="calm">calm</option><option value="boring">boring</option></select>
                     to watch!</p></div><div class="output-section"><button class="delete-btn" style="display: none;">Delete Forever</button><p>Soccer is a 
                        <select id="select-1745575983375-0-0" class="default" data-correct="fantastic"><option value="wonderful">wonderful</option><option value="Horrible">Horrible</option><option value="PLAIN!@#">PLAIN!@#</option><option value="fantastic">fantastic</option></select>
                     sport loved by billions. It’s 
                        <select id="select-1745575983376-0-1" class="default" data-correct="."><option value="simple">simple</option><option value="...">...</option><option value=".">.</option><option value="sad">sad</option><option value="easy">easy</option><option value="complex">complex</option></select>
                     to play, needing only a ball and some 
                        <select id="select-1745575983376-0-2" class="default" data-correct="area"><option value="space">space</option><option value="area">area</option><option value="time">time</option><option value="food">food</option></select>
                    . Fans find it 
                        <select id="select-1745575983376-0-3" class="default" data-correct="thrilling"><option value="exciting">exciting</option><option value="calm">calm</option><option value="boring">boring</option><option value="thrilling">thrilling</option></select>
                     to watch! Soccer is a 
                        <select id="select-1745575983376-0-4" class="default" data-correct="fantastic"><option value="wonderful">wonderful</option><option value="fantastic">fantastic</option><option value="terrible">terrible</option><option value="plain">plain</option></select>
                     sport loved by billions. It’s 
                        <select id="select-1745575983376-0-5" class="default" data-correct="easy"><option value="simple">simple</option><option value="sad">sad</option><option value="easy">easy</option><option value="complex">complex</option></select>
                     to play, needing only a ball and some 
                        <select id="select-1745575983376-0-6" class="default" data-correct="area"><option value="space">space</option><option value="time">time</option><option value="area">area</option><option value="food">food</option></select>
                    . Fans find it 
                        <select id="select-1745575983376-0-7" class="default" data-correct="thrilling"><option value="exciting">exciting</option><option value="calm">calm</option><option value="thrilling">thrilling</option><option value="boring">boring</option></select>
                     to watch!</p></div><div class="output-section"><button class="delete-btn" style="display: none;">Delete Forever</button><p>Soccer is a 
                        <select id="select-1745575995215-0-0" class="default" data-correct="fantastic"><option value="wonderful">wonderful</option><option value="PLAIN!@#">PLAIN!@#</option><option value="fantastic">fantastic</option><option value="Horrible">Horrible</option></select>
                     sport loved by billions. It’s 
                        <select id="select-1745575995215-0-1" class="default" data-correct="."><option value="simple">simple</option><option value="...">...</option><option value=".">.</option><option value="sad">sad</option><option value="easy">easy</option><option value="complex">complex</option></select>
                     to play, needing only a ball and some 
                        <select id="select-1745575995215-0-2" class="default" data-correct="area"><option value="space">space</option><option value="time">time</option><option value="food">food</option><option value="area">area</option></select>
                    . Fans find it 
                        <select id="select-1745575995215-0-3" class="default" data-correct="thrilling"><option value="exciting">exciting</option><option value="boring">boring</option><option value="calm">calm</option><option value="thrilling">thrilling</option></select>
                     to watch! Soccer is a 
                        <select id="select-1745575995215-0-4" class="default" data-correct="fantastic"><option value="wonderful">wonderful</option><option value="terrible">terrible</option><option value="plain">plain</option><option value="fantastic">fantastic</option></select>
                     sport loved by billions. It’s 
                        <select id="select-1745575995215-0-5" class="default" data-correct="easy"><option value="simple">simple</option><option value="easy">easy</option><option value="complex">complex</option><option value="sad">sad</option></select>
                     to play, needing only a ball and some 
                        <select id="select-1745575995215-0-6" class="default" data-correct="area"><option value="space">space</option><option value="time">time</option><option value="area">area</option><option value="food">food</option></select>
                    . Fans find it 
                        <select id="select-1745575995215-0-7" class="default" data-correct="thrilling"><option value="exciting">exciting</option><option value="calm">calm</option><option value="boring">boring</option><option value="thrilling">thrilling</option></select>
                     to watch!Soccer is a 
                        <select id="select-1745575995215-0-8" class="default" data-correct="fantastic"><option value="wonderful">wonderful</option><option value="Horrible">Horrible</option><option value="fantastic">fantastic</option><option value="PLAIN!@#">PLAIN!@#</option></select>
                     sport loved by billions. It’s 
                        <select id="select-1745575995215-0-9" class="default" data-correct="."><option value="simple">simple</option><option value=".">.</option><option value="easy">easy</option><option value="complex">complex</option><option value="...">...</option><option value="sad">sad</option></select>
                     to play, needing only a ball and some 
                        <select id="select-1745575995215-0-10" class="default" data-correct="area"><option value="space">space</option><option value="area">area</option><option value="food">food</option><option value="time">time</option></select>
                    . Fans find it 
                        <select id="select-1745575995216-0-11" class="default" data-correct="thrilling"><option value="exciting">exciting</option><option value="calm">calm</option><option value="thrilling">thrilling</option><option value="boring">boring</option></select>
                     to watch! Soccer is a 
                        <select id="select-1745575995216-0-12" class="default" data-correct="fantastic"><option value="wonderful">wonderful</option><option value="fantastic">fantastic</option><option value="plain">plain</option><option value="terrible">terrible</option></select>
                     sport loved by billions. It’s 
                        <select id="select-1745575995216-0-13" class="default" data-correct="easy"><option value="simple">simple</option><option value="complex">complex</option><option value="easy">easy</option><option value="sad">sad</option></select>
                     to play, needing only a ball and some 
                        <select id="select-1745575995216-0-14" class="default" data-correct="area"><option value="space">space</option><option value="time">time</option><option value="area">area</option><option value="food">food</option></select>
                    . Fans find it 
                        <select id="select-1745575995216-0-15" class="default" data-correct="thrilling"><option value="exciting">exciting</option><option value="calm">calm</option><option value="boring">boring</option><option value="thrilling">thrilling</option></select>
                     to watch!</p></div></div>
    
    
    
    

    <script>
        // Function to escape HTML special characters
        function escapeHtml(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        // Transform button logic
        document.getElementById('transformBtn').addEventListener('click', () => {
            const input = document.getElementById('inputText').value;
            const outputDiv = document.getElementById('output');

            // Create new output section
            const newSection = document.createElement('div');
            newSection.className = 'output-section';

            // Add delete button
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'delete-btn';
            deleteBtn.textContent = 'Delete Forever';
            deleteBtn.addEventListener('click', () => {
                newSection.remove();
            });
            newSection.appendChild(deleteBtn);

            // Split input into paragraphs (handle multiple lines)
            const paragraphs = input.split('\n').filter(p => p.trim());

            // Process each paragraph
            paragraphs.forEach((para, paraIndex) => {
                let paraHtml = para;
                // Match all {{...}} patterns
                const matches = para.matchAll(/{{([^}]+)}}/g);
                let selectCount = 0;

                for (const match of matches) {
                    const words = match[1].split(',').map(w => w.trim()).filter(w => w.length > 0);
                    if (words.length < 2) continue; // Skip invalid markup

                    const defaultWord = escapeHtml(words[0]);
                    const correctWord = escapeHtml(words[1]);
                    const distractors = words.slice(2).map(w => escapeHtml(w));

                    // Generate unique ID for select
                    const selectId = `select-${Date.now()}-${paraIndex}-${selectCount++}`;
                    const selectHtml = `
                        <select id="${selectId}" class="default" data-correct="${correctWord}">
                            <option value="${defaultWord}" selected>${defaultWord}</option>
                            <option value="${correctWord}">${correctWord}</option>
                            ${distractors.map(d => `<option value="${d}">${d}</option>`).join('')}
                        </select>
                    `;
                    // Replace {{...}} with select HTML
                    paraHtml = paraHtml.replace(match[0], selectHtml);
                }

                // Add paragraph to new section
                const p = document.createElement('p');
                p.innerHTML = paraHtml;
                newSection.appendChild(p);
            });

            // Append new section to output (adds at bottom of #output, above textarea)
            outputDiv.appendChild(newSection);

            // Add event listeners to all selects in the new section
            newSection.querySelectorAll('select').forEach(select => {
                const correctWord = select.getAttribute('data-correct');
                const defaultWord = select.options[0].value;

                // Shuffle options (excluding default)
                const opts = Array.from(select.options).slice(1);
                opts.sort(() => Math.random() - 0.5);
                select.innerHTML = '';
                const defaultOption = document.createElement('option');
                defaultOption.value = defaultWord;
                defaultOption.textContent = defaultWord;
                defaultOption.selected = true;
                select.appendChild(defaultOption);
                opts.forEach(opt => select.appendChild(opt));

                // Explicitly set initial value to ensure default word displays
                select.value = defaultWord;

                select.addEventListener('change', () => {
                    const selectedValue = select.value;
                    if (selectedValue === defaultWord) {
                        select.className = 'default';
                    } else if (selectedValue === correctWord) {
                        select.className = 'correct';
                    } else {
                        select.className = 'incorrect';
                    }
                });
            });
        });

        // Save to Download Folder button logic
        document.getElementById('saveBtn').addEventListener('click', () => {
            // Clone the document
            const clonedDoc = document.cloneNode(true);

            // Hide delete buttons in the cloned document
            clonedDoc.querySelectorAll('.delete-btn').forEach(btn => {
                btn.style.display = 'none';
            });

            // Remove the Save button, Transform button, textarea, and file name input from the cloned document
            const saveBtn = clonedDoc.getElementById('saveBtn');
            if (saveBtn) saveBtn.remove();
            const transformBtn = clonedDoc.getElementById('transformBtn');
            if (transformBtn) transformBtn.remove();
            const textarea = clonedDoc.getElementById('inputText');
            if (textarea) textarea.remove();
            const fileNameInput = clonedDoc.getElementById('fileNameInput');
            if (fileNameInput) fileNameInput.remove();

            // Add script to handle select interactions in the saved file
            const script = clonedDoc.createElement('script');
            script.textContent = `
                document.querySelectorAll('select').forEach(select => {
                    const correctWord = select.getAttribute('data-correct');
                    const defaultWord = select.options[0].value;

                    select.addEventListener('change', () => {
                        const selectedValue = select.value;
                        if (selectedValue === defaultWord) {
                            select.className = 'default';
                        } else if (selectedValue === correctWord) {
                            select.className = 'correct';
                        } else {
                            select.className = 'incorrect';
                        }
                    });
                });
            `;
            clonedDoc.body.appendChild(script);

            // Get the file name from the input
            let fileName = document.getElementById('fileNameInput').value.trim();
            if (fileName) {
                // Sanitize file name: replace spaces with hyphens, remove special characters
                fileName = fileName.replace(/[^a-zA-Z0-9-_]/g, '-').replace(/-+/g, '-');
                if (!fileName.endsWith('.html')) {
                    fileName += '.html';
                }
            } else {
                fileName = 'vocabulary-exercise.html';
            }

            // Get the HTML content
            const htmlContent = '<!DOCTYPE html>\n' + clonedDoc.documentElement.outerHTML;

            // Create a Blob with the HTML content
            const blob = new Blob([htmlContent], { type: 'text/html' });

            // Create a downloadable link
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();

            // Clean up
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });
    </script>


<script>
                document.querySelectorAll('select').forEach(select => {
                    const correctWord = select.getAttribute('data-correct');
                    const defaultWord = select.options[0].value;

                    select.addEventListener('change', () => {
                        const selectedValue = select.value;
                        if (selectedValue === defaultWord) {
                            select.className = 'default';
                        } else if (selectedValue === correctWord) {
                            select.className = 'correct';
                        } else {
                            select.className = 'incorrect';
                        }
                    });
                });
            </script></body></html>